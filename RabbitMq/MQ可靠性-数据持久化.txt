MQ可靠性

	默认情况,MQ收到的信息保存在内存中降低消息收发的延迟

	导致两个问题:

		MQ宕机,内存中消息丢失
		内存有限,消费者故障或处理慢时,消息积压,MQ阻塞


	其中,在spring中发送信息默认时持久化的,

数据持久化:	
	
		交换机持久化:		在创建交换机和队列的时候,勾选持久化模式即可		
		队列持久化:		在创建交换机和队列的时候,勾选持久化模式即可
		消息持久化:		MQ发送消息时,选择持久化的消息发送,选择delivery_mode: 2
		

Lazy Queue

	MQ3,6版本的,惰性队列

	特征:	收到消息存在磁盘而不是内存,内存只保留最近消息,默认2048
			消费者要消费消息时才会从磁盘读取并加载到内存
			支持百万消息储存

	在3.12版本后,所有队列都是LazyQueue模式,无法修改


	lazyQueue速度很快,可以保持消息发送速度峰值


	也就是MQ的持久化  只要保证交换机,队列和消息都是持久化的即可.这样mq宕机消息依然存在
	3.6版本后引入LazyQueue,在3.12设为默认.lazyQueue会将消息都持久化
	开启持久化和生产者确认时,MQ只有在消息持久化完成后才发生ack回执信息




